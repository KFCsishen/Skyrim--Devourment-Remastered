; Comments start with ; or # character on a new line, these lines are ignored
; See the read-me at http://www.nexusmods.com/skyrim/mods/49036/? or in
; downloaded mod archive for documentation on how to configure

; Keycode IDs:
; https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx
; numpad 8 reloads, uncomment to bind numpad9 to toggle view and numpad 7 to attach camera on crosshair target
!bindkey 0x68 0 "ReloadIFPV"
;!bindkey 0x69 0 "ToggleIFPV"
;!bindkey 0x67 0 "AttachIFPV"
;!bindkey2 0x65 0 "ToggleHeadTrack"
;!bindkey 0x63 0 "ToggleHead"
!bindkey 0x64 0 "ToggleHelmetCamOn"

; Uncomment these two to allow free looking while numpad 6 is held (character doesn't turn to crosshair)
;!bindkey2 0x66 0 "TurnFreeLookOn"
;!bindkey2 -0x66 0 "TurnFreeLookOff"

; Camera position offsets from eyes center in game units. If you are using beast race then scroll down for offsets.
!set fPositionOffsetHorizontal 1
!set fPositionOffsetVertical 2
!set fPositionOffsetDepth -10

; How much rotation is applied from head. 1 means camera direction equals head rotation, 0 means camera direction
; equals look direction. 0.5 would be the middle.
!set fRotationFromHead 0

; Restrict view angle so you can't look yourself in the eye.
!set fRestrictAngleHorizontal 80
!set fRestrictAngleVertical 90

; set both false if you don't want to overwrite vanilla FP, you could instead use then custom keybind
!set bZoomIntoIFPV true
!set bToggleIntoIFPV true

; Set true to allow head tracking crosshair in third person view.
!set bHeadtrack false

; Some internal values. Ignore these.
!set fExtraRotationFromCamera 0
!set fUpdateProfileInterval 0.2
!set fTweenLength 0.2
!set iDebug 0
!set bEnabled true
!set bActivated false
!set iUnused1 0
!set iUnused2 0
!set iUnused3 0
!set iFaceCrosshair 0
!set bHideHead false
!set bHideHelmet false
!set bArrowCamera false
!set iIgnoreWorldCollision 0

; Profiles are selected from top to bottom, whichever first satisfies all conditions
; Profiles without any conditions are never selected but can be entered through command or keybind
; Profiles that use "skip" command are not selected automatically
; Profiles that use "disable" command are not loaded

; Normal profiles

[ToggleIFPV]
; this profile will not be selected automatically because there are no conditions, but it was bound to key
+GoThirdPerson
+modifynooverride bActivated true

[ReloadIFPV]
+reload

[AttachIFPV]
; Attach camera to crosshair target so you can see through their eyes, you don't gain control of them
+AttachCamera

[TurnFreeLookOn]
+setnooverride iUnused1 1

[TurnFreeLookOff]
+setnooverride iUnused1 0

[ToggleHeadTrack]
+modifynooverride bHeadtrack true

[ToggleHead]
+modifynooverride bHidehead true

[ToggleHelmetCamOn]
+setnooverride iUnused3 1
-bindkey 0x64 0 "ToggleHelmetCamOff"

[ToggleHelmetCamOff]
+setnooverride iUnused3 0
-bindkey 0x64 0 "ToggleHelmetCamOn"

{ArrowCam}
(bIsActive==true)
(bIsCameraOnArrow==true)
+set fNearClip 5
+set fRotationFromHead 0.991
+set fPositionOffsetDepth 8
+set fPositionOffsetHorizontal 0
+set fPositionOffsetVertical 3
+set fRestrictAngleHorizontal 180
+set fRestrictAngleVertical 180
+set fExtraRotationFromCamera 0.95
+set fTimescale 0.2
+set iIgnoreWorldCollision 1
-return fRotationFromHead
-return fPositionOffsetDepth
-return fPositionOffsetHorizontal
-return fPositionOffsetVertical
-return fTimescale
-return iIgnoreWorldCollision
-return fRestrictAngleHorizontal
-return fRestrictAngleVertical
-return fExtraRotationFromCamera
-return fNearClip

{SLProfile}
(bIsActive==true)
(Keyword&SexLabActive)
+set fRotationFromHead 1
-return fRotationFromHead
+set fExtraRotationFromCamera 1
-return fExtraRotationFromCamera
+set bHeadtrack false
-return bHeadtrack
+set fNearClip 1
-return fNearClip

; Used in the toggle free look hotkey.
{FreeLook}
(iUnused1==1)
+set iFaceCrosshair -1
-return iFaceCrosshair

; Disable IFPV during VATS.
{Cinematic3rdPersonCam}
(iCameraState==2)
+set bActivated false
-return bActivated

{AllowLookDuringKillmove}
(bKillMove==true)
(bIsActive==true)
+set fExtraRotationMouse 1.3
-return fExtraRotationMouse
; This profile has been found to cause problems. So it's disabled.
disable

; This is for furniture used during crafting.
{CraftingFurniture}
(iUnused2==1)
(bIsActive==true)
+set fRotationFromHead 1
-return fRotationFromHead
+set bHeadtrack false
-return bHeadtrack
+set fNearClip 4
-return fNearClip

; These are used to trigger crafting furniture profile. This might not work on non-english localized Skyrim!
{AlchemyFurniture}
(sFurniture&alchemy)
+set iUnused2 1
-return iUnused2
{EnchantingFurniture}
(sFurniture&enchanter)
+set iUnused2 1
-return iUnused2
{ForgeFurniture}
(sFurniture&forge)
+set iUnused2 1
-return iUnused2
{CookingFurniture}
(sFurniture&cooking)
+set iUnused2 1
-return iUnused2
{GrindstoneFurniture}
(sFurniture&grind)
+set iUnused2 1
-return iUnused2
{SmelterFurniture}
(sFurniture&smelter)
+set iUnused2 1
-return iUnused2
{SkinningFurniture}
(sFurniture&tanning)
+set iUnused2 1
-return iUnused2
{WorkbenchFurniture}
(sFurniture&workbench)
+set iUnused2 1
-return iUnused2
{AnvilFurniture}
(sFurniture&anvil)
+set iUnused2 1
-return iUnused2

; Turns character when you reach certain angle in free look mode, disabled by default
{LeftTurn}
; 1.2217 rad = 70 deg
(fCameraViewOffsetHorizontal<-1.2217)
(bMounted==false)
(bIsActive==true)
+set iFaceCrosshair 2
-return iFaceCrosshair
; Remove the line "disable" to enable auto-turn character when looking left past certain degree
disable

; Turns character when you reach certain angle in free look mode, disabled by default
{RightTurn}
(fCameraViewOffsetHorizontal>1.2217)
(bMounted==false)
(bIsActive==true)
+set iFaceCrosshair 2
-return iFaceCrosshair
; Remove the line "disable" to enable auto-turn character when looking right past certain degree
disable

; Change camera position a bit during vampire lord
{VampireLord}
(bVampireLord==true)
(bIsActive==true)
+set fPositionOffsetDepth 10
-return fPositionOffsetDepth

; Change camera position a bit during werewolf
{WerewolfForm}
(bWereWolf==true)
(bIsActive==true)
+set fPositionOffsetDepth 10
-return fPositionOffsetDepth

{Mounting}
(bMounting==true)
(bIsActive==true)
+set fNearClip 3
-return fNearClip

{Dismounting}
(bDismounting==true)
(bIsActive==true)
+set fNearClip 3
-return fNearClip

{CombatInVanillaFirstPerson}
(bWeaponOut==true)
(bIsActive==true)
+GoFirstPerson
-GoThirdPerson
; Remove the "disable" on next line to make all combat in vanilla first person view.
disable

{SittingChange}
(iCameraState==5)
(bIsActive==true)
+set bHeadtrack false
-return bHeadtrack
+set fRotationFromHead 1
-return fRotationFromHead

{CraftingChange}
(iCameraState==8)
(bIsActive==true)
+set bHeadtrack false
-return bHeadtrack
+set fRotationFromHead 1
-return fRotationFromHead

{TransitionCam}
(iCameraState==6)
(bIsActive==true)
+set bHeadtrack false
-return bHeadtrack
+set fRotationFromHead 1
-return fRotationFromHead

{BleedoutCam}
(iCameraState==11)
(bIsActive==true)
+set bHeadtrack false
-return bHeadtrack
+set fRotationFromHead 1
-return fRotationFromHead

{BowAimingInVanillaFirstPerson}
(bAimBow==true)
(bIsActive==true)
+GoFirstPerson
-GoThirdPerson
; Remove "disable" to automatically switch to vanilla FP during bow aim
disable

; Bow aiming profile. Disable head tracking because it will mess up everything.
{BowAiming}
(bAimBow==true)
(bIsActive==true)
+set bHeadtrack false
-return bHeadtrack
+set fRotationFromHead 0
-return fRotationFromHead

; Mounted horse profile, restrict camera angle a bit more.
{Mounted}
(bMounted==true)
(bIsActive==true)
+set fRestrictAngleHorizontal 70
+set fRestrictAngleVertical 50
-return fRestrictAngleHorizontal
-return fRestrictAngleVertical

; Profile for if user has enabled helmet cam (see their hat).
{HelmetCam}
(iUnused3==1)
(bIsActive==true)
+set fPositionOffsetHorizontal 0
+set fPositionOffsetVertical -1
+set fPositionOffsetDepth -5
+set fNearClip 1.0
+set bHideHead true
+set bHideHelmet false
-return fPositionOffsetHorizontal
-return fPositionOffsetVertical
-return fPositionOffsetDepth
-return fNearClip
-return bHideHead
-return bHideHelmet

; Beast race offsets for khajiit. Move camera forward and up a bit.
{BeastRaceKhajiit}
(sRace&khajiit)
(bIsInIFPV==true)
+set fPositionOffsetDepth 5
-return fPositionOffsetDepth
+set fPositionOffsetVertical 1
-return fPositionOffsetVertical
; This profile is not necessary since head can be hidden reliably.
disable

; Beast race offsets for argonian. Move camera forward and up a bit.
{BeastRaceArgonian}
(sRace&argonia)
(bIsInIFPV==true)
+set fPositionOffsetDepth 5
-return fPositionOffsetDepth
+set fPositionOffsetVertical 1
-return fPositionOffsetVertical
; This profile is not necessary since head can be hidden reliably.
disable

; Automatically adjust near clip when looking down past 45 degree angle.
{AdjustNearClipDown45}
(bIsInIFPV==true)
(fLookDirX<-0.8)
+set fNearClip 5.0
-return fNearClip

; Automatically adjust near clip when looking up past 45 degree angle.
{AdjustNearClipUp45}
(bIsInIFPV==true)
(fLookDirX>0.8)
+set fNearClip 5.0
-return fNearClip

; Automatically set near clip 8 indoors (15 is default).
{AdjustNearClipIndoors}
(bIsInIFPV==true)
(bIndoors==true)
+set fNearClip 8.0
-return fNearClip

; Main IFPV configuration that isn't overrided by other profiles.
{Main}
(bIsInIFPV==true)
; Set near clip to larger value to fix mountain flicker or lower value to reduce clipping nearby objects.
; These are now disabled here because separate profile controls based on angle.
;+set fNearClip 7.0
;-return fNearClip
; Set in next line true to false, to not allow head tracking crosshair
+set bHeadtrack true
-return bHeadtrack
; Set next line from true to false to allow third person cinematic killmoves while in IFPV.
+set bDisableVATS true
-return bDisableVATS
; Set character turns to crosshair or not.
; 0 = let game decide (normal behavior)
; 1 = always turn like weapon is drawn
; -1 = force not turning character ever
; -2 = character doesn't auto-turn when weapons are out but still turns if you move or attack
;      (can be good to fix "wobble" during weapon out turning)
+set iFaceCrosshair -2
-return iFaceCrosshair
+set bHideHead true
-return bHideHead
; Set true instead of false on next line if you want to hide helmet by default. This was causing a bug sometimes where whole body disappears so it's disabled.
+set bHideHelmet false
-return bHideHelmet
; Overwrite default up down limit in radians. pi / 2 is 90 degrees. This is set so we can exceed 90 angle limit with fRestrictAngleVertical
+set fUpDownLimit 2.0
-return fUpDownLimit
